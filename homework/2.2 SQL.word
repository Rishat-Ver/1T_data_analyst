-- Смотрю таблицу
SELECT * FROM mall_customers LIMIT 1;

-----------------------------------------------------------------------------------------------------------------------------------------------
1. Напишите запрос, который вернёт долю мужчин и женщин среди посетителей магазина.
   (Хинт: количество посетителей можно посчитать отдельно).

SELECT "Genre",
       round((count(DISTINCT "CustomerID"):: numeric / (SELECT count(DISTINCT "CustomerID") FROM mall_customers) * 100)) AS proportion
  FROM mall_customers
 GROUP BY "Genre";

-----------------------------------------------------------------------------------------------------------------------------------------------
2. Напишите запрос, который вернёт всех мужчин, отсортированных по возрастанию возраста,
 убыванию Annual_Income и возрастанию Spending_Score (используйте иерархическую сортировку).

SELECT *
  FROM mall_customers
 WHERE "Genre" = 'Male'
 ORDER BY "Age",
          "Annual_Income" DESC,
          "Spending_Score";
-----------------------------------------------------------------------------------------------------------------------------------------------

